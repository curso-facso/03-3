<!DOCTYPE html>
<html lang="en"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.553">

  <title>Métodos computacionales para las ciencias sociales</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="style.css">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="index_files/libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="index_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Métodos computacionales para las ciencias sociales</h1>
  <p class="subtitle">Herramientas para datasets grandes</p>

<div class="quarto-title-authors">
</div>

</section>
<section id="contenidos" class="slide level2">
<h2>Contenidos</h2>
<ul>
<li>Estrategias simples</li>
<li>arrow</li>
<li>data.table</li>
<li>bases de datos</li>
</ul>
</section>
<section id="motivación" class="slide level2">
<h2>Motivación</h2>
<p>Estoy interesado en trabajar con datos del Censo de 2017</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a>personas <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/csv-personas-censo-2017/Microdato_Censo2017-Personas.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>R asigna aproximadamente 6.3 GB en memoria</p>
<p>Durante la carga se llegan a necesitar más de 12 GB</p>
<div class="fragment">
<p><strong>Consecuencia</strong>: Si tengo menos de 12 GB, probablemente, tendré problemas para cargar el archivo</p>
</div>
</section>
<section>
<section id="alguna-idea" class="title-slide slide level1 center">
<h1>¿Alguna idea?</h1>

</section>
<section id="exploremos-las-primeras-100-filas-del-archivo-con-el-parámetro-n_max" class="slide level2">
<h2>Exploremos las primeras 100 filas del archivo con el parámetro n_max</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a>personas <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/csv-personas-censo-2017/Microdato_Censo2017-Personas.csv"</span>, </span>
<span id="cb2-2"><a href=""></a>                      <span class="at">n_max =</span> <span class="dv">100</span>)</span>
<span id="cb2-3"><a href=""></a><span class="fu">names</span>(personas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "REGION"        "PROVINCIA"     "COMUNA"        "DC"           
 [5] "AREA"          "ZC_LOC"        "ID_ZONA_LOC"   "NVIV"         
 [9] "NHOGAR"        "PERSONAN"      "P07"           "P08"          
[13] "P09"           "P10"           "P10COMUNA"     "P10PAIS"      
[17] "P11"           "P11COMUNA"     "P11PAIS"       "P12"          
[21] "P12COMUNA"     "P12PAIS"       "P12A_LLEGADA"  "P12A_TRAMO"   
[25] "P13"           "P14"           "P15"           "P15A"         
[29] "P16"           "P16A"          "P16A_OTRO"     "P17"          
[33] "P18"           "P19"           "P20"           "P21M"         
[37] "P21A"          "P10PAIS_GRUPO" "P11PAIS_GRUPO" "P12PAIS_GRUPO"
[41] "ESCOLARIDAD"   "P16A_GRUPO"    "REGION_15R"    "PROVINCIA_15R"
[45] "COMUNA_15R"    "P10COMUNA_15R" "P11COMUNA_15R" "P12COMUNA_15R"</code></pre>
</div>
</div>
</section>
<section id="antes-de-seguir" class="slide level2">
<h2>Antes de seguir</h2>
<p><strong>Terminología:</strong></p>
<ul>
<li>Memoria: almacenamiento de acceso rápido</li>
<li>Disco: capacidad de almacenamiento</li>
<li>Procesador: capacidad de procesar datos</li>
</ul>
</section>
<section id="seleccionando-columnas" class="slide level2">
<h2>Seleccionando columnas</h2>
<p>Estamos interesados en estudiar la escolaridad a nivel comunal</p>
<div class="fragment">
<p>Podemos seleccionar solo las columnas que necesitamos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a>time1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb4-2"><a href=""></a>personas <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/csv-personas-censo-2017/Microdato_Censo2017-Personas.csv"</span>, </span>
<span id="cb4-3"><a href=""></a>                      <span class="at">col_select =</span> <span class="fu">c</span>(<span class="st">"COMUNA"</span>, <span class="st">"P08"</span>, <span class="st">"P09"</span>, <span class="st">"ID_ZONA_LOC"</span>, <span class="st">"AREA"</span>, <span class="st">"NVIV"</span>, <span class="st">"ESCOLARIDAD"</span>)</span>
<span id="cb4-4"><a href=""></a>)</span>
<span id="cb4-5"><a href=""></a>time2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a>memoria_asignada <span class="ot">&lt;-</span>  <span class="fu">object.size</span>(personas)[[<span class="dv">1</span>]] <span class="sc">/</span> <span class="dv">1073741824</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "La nueva variable requiere 0.9166 gigas en memoria"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "El tiempo de lectura es de  6.11482310295105 segundos"</code></pre>
</div>
</div>
<p>Pueden seguir habiendo problemas para cargar, pero vamos mejorando</p>
</div>
</section>
<section id="experimento" class="slide level2">
<h2>Experimento</h2>
<p>Experimenten en sus computadores</p>
<div class="fragment">
<p>Utilizando el siguiente código, prueben diferentes números de filas en n_max y vean cómo responden sus computadores.</p>
</div>
<div class="fragment">
<p>Testeen con los siguientes valores: 1.000, 10.000, 100.000, 1.000.000, 10.000.000, 15.000.000</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a>time1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb8-2"><a href=""></a>personas <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/csv-personas-censo-2017/Microdato_Censo2017-Personas.csv"</span>, </span>
<span id="cb8-3"><a href=""></a>                      <span class="at">n_max =</span> <span class="dv">1000000</span></span>
<span id="cb8-4"><a href=""></a>)</span>
<span id="cb8-5"><a href=""></a>time2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb8-6"><a href=""></a><span class="fu">sprintf</span>(<span class="st">"El tiempo de lectura es de  %s segundos"</span>, <span class="fu">round</span>(time2 <span class="sc">-</span>time1, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="ahora-calculemos-algunas-cosas" class="slide level2">
<h2>Ahora calculemos algunas cosas</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="fu">library</span>(dplyr)</span>
<span id="cb9-2"><a href=""></a></span>
<span id="cb9-3"><a href=""></a><span class="fu">tic</span>()</span>
<span id="cb9-4"><a href=""></a>media_escolaridad <span class="ot">&lt;-</span>  personas <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href=""></a>  <span class="fu">rename</span>(<span class="at">sexo =</span> P08,</span>
<span id="cb9-6"><a href=""></a>         <span class="at">edad =</span> P09) <span class="sc">%&gt;%</span> </span>
<span id="cb9-7"><a href=""></a>  <span class="fu">filter</span>(edad <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> edad <span class="sc">&lt;=</span> <span class="dv">60</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb9-8"><a href=""></a>  <span class="fu">group_by</span>(COMUNA) <span class="sc">%&gt;%</span> </span>
<span id="cb9-9"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">media =</span> <span class="fu">round</span>(<span class="fu">mean</span>(ESCOLARIDAD), <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-10"><a href=""></a>  <span class="fu">left_join</span>(etiquetas, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"COMUNA"</span> <span class="ot">=</span> <span class="st">"valor"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href=""></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(media))</span>
<span id="cb9-12"><a href=""></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.781 sec elapsed</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a>media_escolaridad</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 346 × 3
   COMUNA media glosa         
    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         
 1  13502  21.5 Alhué         
 2  13123  17.9 Providencia   
 3  13114  17.4 Las Condes    
 4  13132  17.3 Vitacura      
 5  13120  16.9 Ñuñoa         
 6   1403  16.8 Colchane      
 7   5201  16.7 Isla de Pascua
 8  13101  16.2 Santiago      
 9  13113  16.1 La Reina      
10   5604  15.9 El Quisco     
# ℹ 336 more rows</code></pre>
</div>
</div>
</section>
<section id="probemos-más-desagregaciones" class="slide level2">
<h2>Probemos más desagregaciones</h2>
<p>Repetimos, pero incluyendo sexo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="fu">tic</span>()</span>
<span id="cb13-2"><a href=""></a>media_escolaridad <span class="ot">&lt;-</span>  personas <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href=""></a>  <span class="fu">rename</span>(<span class="at">sexo =</span> P08,</span>
<span id="cb13-4"><a href=""></a>         <span class="at">edad =</span> P09) <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href=""></a>  <span class="fu">filter</span>(edad <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> edad <span class="sc">&lt;=</span> <span class="dv">60</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb13-6"><a href=""></a>  <span class="fu">group_by</span>(COMUNA, sexo) <span class="sc">%&gt;%</span> </span>
<span id="cb13-7"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">media =</span> <span class="fu">round</span>(<span class="fu">mean</span>(ESCOLARIDAD), <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-8"><a href=""></a>  <span class="fu">left_join</span>(etiquetas, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"COMUNA"</span> <span class="ot">=</span> <span class="st">"valor"</span>)) </span>
<span id="cb13-9"><a href=""></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.772 sec elapsed</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a>media_escolaridad</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 692 × 4
# Groups:   COMUNA [346]
   COMUNA  sexo media glosa        
    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        
 1   1101     1  14.5 Iquique      
 2   1101     2  14.2 Iquique      
 3   1107     1  13.6 Alto Hospicio
 4   1107     2  13.1 Alto Hospicio
 5   1401     1  14.3 Pozo Almonte 
 6   1401     2  12.4 Pozo Almonte 
 7   1402     1  14.7 Camiña       
 8   1402     2  16.4 Camiña       
 9   1403     1  18.0 Colchane     
10   1403     2  15.1 Colchane     
# ℹ 682 more rows</code></pre>
</div>
</div>
</section>
<section id="complejicemos-el-procesamiento" class="slide level2">
<h2>Complejicemos el procesamiento</h2>
<p>Vamos a incluir tramo etario</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a>personas_editado <span class="ot">&lt;-</span>  personas <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href=""></a>  <span class="fu">rename</span>(<span class="at">sexo =</span> P08,</span>
<span id="cb17-3"><a href=""></a>         <span class="at">edad =</span> P09,</span>
<span id="cb17-4"><a href=""></a>         <span class="at">area =</span> AREA</span>
<span id="cb17-5"><a href=""></a>         ) <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">tramo_edad =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-7"><a href=""></a>    edad <span class="sc">&lt;=</span> <span class="dv">9</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb17-8"><a href=""></a>    edad <span class="sc">&lt;=</span> <span class="dv">19</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb17-9"><a href=""></a>    edad <span class="sc">&lt;=</span> <span class="dv">29</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb17-10"><a href=""></a>    edad <span class="sc">&lt;=</span> <span class="dv">39</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb17-11"><a href=""></a>    edad <span class="sc">&lt;=</span> <span class="dv">49</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb17-12"><a href=""></a>    edad <span class="sc">&lt;=</span> <span class="dv">59</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb17-13"><a href=""></a>    edad <span class="sc">&lt;=</span> <span class="dv">69</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb17-14"><a href=""></a>    edad <span class="sc">&lt;=</span> <span class="dv">79</span> <span class="sc">~</span> <span class="dv">8</span>,</span>
<span id="cb17-15"><a href=""></a>    edad <span class="sc">&lt;=</span> <span class="dv">89</span> <span class="sc">~</span> <span class="dv">9</span>,</span>
<span id="cb17-16"><a href=""></a>    edad <span class="sc">&lt;=</span> <span class="dv">99</span> <span class="sc">~</span> <span class="dv">10</span>,</span>
<span id="cb17-17"><a href=""></a>    edad <span class="sc">&gt;=</span> <span class="dv">100</span> <span class="sc">~</span> <span class="dv">11</span></span>
<span id="cb17-18"><a href=""></a>  )) </span>
<span id="cb17-19"><a href=""></a></span>
<span id="cb17-20"><a href=""></a><span class="fu">tic</span>()</span>
<span id="cb17-21"><a href=""></a>resultado <span class="ot">&lt;-</span> personas_editado <span class="sc">%&gt;%</span> </span>
<span id="cb17-22"><a href=""></a>  <span class="fu">group_by</span>(COMUNA, sexo, tramo_edad, area) <span class="sc">%&gt;%</span> </span>
<span id="cb17-23"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">media =</span> <span class="fu">round</span>(<span class="fu">mean</span>(ESCOLARIDAD), <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-24"><a href=""></a>  <span class="fu">left_join</span>(etiquetas, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"COMUNA"</span> <span class="ot">=</span> <span class="st">"valor"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-25"><a href=""></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(media))</span>
<span id="cb17-26"><a href=""></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.075 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="aún-más-complejidad" class="slide level2">
<h2>Aún más complejidad</h2>
<p>Ahora calculamos la media para más de 9.000.000 de grupos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a>media_escolaridad <span class="ot">&lt;-</span>  personas <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href=""></a>  <span class="fu">rename</span>(<span class="at">sexo =</span> P08,</span>
<span id="cb19-3"><a href=""></a>         <span class="at">edad =</span> P09) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">id_viv =</span> <span class="fu">paste0</span>(ID_ZONA_LOC, NVIV)) </span>
<span id="cb19-5"><a href=""></a></span>
<span id="cb19-6"><a href=""></a><span class="fu">tic</span>()</span>
<span id="cb19-7"><a href=""></a>personas_vivienda <span class="ot">&lt;-</span> media_escolaridad <span class="sc">%&gt;%</span> </span>
<span id="cb19-8"><a href=""></a>  <span class="fu">group_by</span>(id_viv, sexo) <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">media =</span> <span class="fu">round</span>(<span class="fu">mean</span>(ESCOLARIDAD), <span class="dv">2</span>))</span>
<span id="cb19-10"><a href=""></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>41.075 sec elapsed</code></pre>
</div>
</div>
<div class="fragment">
<p><strong>¿Qué pasa si tengo que correr un proceso que ejecuta 20 tareas similares varias veces al día?</strong></p>
</div>
<div class="fragment">
<p><strong><code>dplyr</code> es una excelente herramienta, pero este tiempo torna inviable procesamientos largos y reiterados</strong></p>
</div>
</section>
<section id="introducción-a-data.table" class="slide level2">
<h2>Introducción a data.table</h2>
<p><code>data.table</code> es un paquete pensado para minimizar el tiempo de ejecución</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/data.table_-1.webp" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
<div class="fragment">
<p><strong>Desventaja</strong>: está fuera del mundo <code>tidyverse</code> y su sintaxis es completamente diferente</p>
</div>
</section>
<section id="introducción-a-data.table-1" class="slide level2">
<h2>Introducción a data.table</h2>
<p>Instalación</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="fu">install.packages</span>(<span class="st">"data.table"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>Para cargar un archivo csv, contamos con la función fread</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a><span class="fu">library</span>(data.table)</span>
<span id="cb22-2"><a href=""></a>personas <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"data/csv-personas-censo-2017/Microdato_Censo2017-Personas.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="comparación-en-lectura" class="slide level2">
<h2>Comparación en lectura</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a>personas <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/csv-personas-censo-2017/Microdato_Censo2017-Personas.csv"</span>, </span>
<span id="cb23-2"><a href=""></a>                      <span class="at">col_select =</span> <span class="fu">c</span>(<span class="st">"COMUNA"</span>, <span class="st">"P08"</span>, <span class="st">"P09"</span>, <span class="st">"ID_ZONA_LOC"</span>, </span>
<span id="cb23-3"><a href=""></a>                                     <span class="st">"AREA"</span>, <span class="st">"NVIV"</span>, <span class="st">"ESCOLARIDAD"</span>))</span>
<span id="cb23-4"><a href=""></a></span>
<span id="cb23-5"><a href=""></a>memoria_asignada_dplyr <span class="ot">&lt;-</span>  <span class="fu">object.size</span>(personas)[[<span class="dv">1</span>]] <span class="sc">/</span> <span class="dv">1073741824</span></span>
<span id="cb23-6"><a href=""></a><span class="fu">class</span>(personas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a>tiempo_dplyr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 6.114823 secs</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "La variable requiere 0.9166 gigas en memoria"</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href=""></a><span class="fu">tic</span>()</span>
<span id="cb27-2"><a href=""></a>personas <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"data/csv-personas-censo-2017/Microdato_Censo2017-Personas.csv"</span>,</span>
<span id="cb27-3"><a href=""></a>                  <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"COMUNA"</span>, <span class="st">"P08"</span>, <span class="st">"P09"</span>, <span class="st">"ID_ZONA_LOC"</span>, </span>
<span id="cb27-4"><a href=""></a>                                     <span class="st">"AREA"</span>, <span class="st">"NVIV"</span>, <span class="st">"ESCOLARIDAD"</span>))</span>
<span id="cb27-5"><a href=""></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.358 sec elapsed</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href=""></a>memoria_asignada_dt <span class="ot">&lt;-</span>  <span class="fu">object.size</span>(personas)[[<span class="dv">1</span>]] <span class="sc">/</span> <span class="dv">1073741824</span></span>
<span id="cb29-2"><a href=""></a><span class="fu">class</span>(personas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.table" "data.frame"</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "La nueva variable requiere 0.4583 gigas en memoria"</code></pre>
</div>
</div>
</div>
</section>
<section id="comparación-en-procesamiento" class="slide level2">
<h2>Comparación en procesamiento</h2>
<p>Vimos que dplyr se demoraba ~37 segundos en este procesamiento</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href=""></a>media_escolaridad <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href=""></a>  <span class="fu">group_by</span>(id_viv, sexo) <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">media =</span> <span class="fu">round</span>(<span class="fu">mean</span>(ESCOLARIDAD), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>Veamos cómo sería en el caso de <code>data.table</code></p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a>personas[, id_viv <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>( <span class="fu">paste0</span>(ID_ZONA_LOC, NVIV))]</span>
<span id="cb33-2"><a href=""></a><span class="fu">colnames</span>(personas)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"sexo"</span></span>
<span id="cb33-3"><a href=""></a><span class="fu">colnames</span>(personas)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"edad"</span></span>
<span id="cb33-4"><a href=""></a></span>
<span id="cb33-5"><a href=""></a><span class="fu">tic</span>()</span>
<span id="cb33-6"><a href=""></a>personas_vivienda <span class="ot">&lt;-</span> personas[, <span class="fu">round</span>(<span class="fu">mean</span>(ESCOLARIDAD), <span class="dv">2</span>) , by <span class="ot">=</span> .(id_viv, sexo)]</span>
<span id="cb33-7"><a href=""></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>22.051 sec elapsed</code></pre>
</div>
</div>
</div>
</section>
<section id="sintaxis-básica-de-data.table" class="slide level2">
<h2>Sintaxis básica de data.table</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/dt_index.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
<h3 id="i-corresponde-a-las-filas."><span style="color:red">i</span>: corresponde a las filas.</h3>
<h3 id="j-corresponde-a-las-columnas."><span style="color:steelblue">j</span>: corresponde a las columnas.</h3>
<h3 id="by-corresponde-a-las-agrupaciones-que-queremos-hacer."><span style="color:green">by</span>: corresponde a las agrupaciones que queremos hacer.</h3>
</section>
<section id="sintaxis-básica" class="slide level2">
<h2>Sintaxis básica</h2>
<p><br> <br> <br> <br></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/I_.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</section>
<section id="sintaxis-básica-1" class="slide level2">
<h2>Sintaxis básica</h2>
<h3 id="parametro-i">Parametro <span style="color:red">i</span>:</h3>
<p><strong>Nos permite</strong>:</p>
<ul>
<li><p>Indexar filas.</p></li>
<li><p>Filtrar filas por valores o categorías.</p></li>
<li><p>Aplicar funciones específicas por filas.</p></li>
</ul>
</section>
<section id="sintaxis-básica-ejemplos" class="slide level2">
<h2>Sintaxis básica: ejemplos</h2>
<h3 id="parametro-i-1">Parametro <span style="color:red">i</span>:</h3>
<p>Filtremos las primeras 6 filas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a><span class="co"># Podemos filtrar así</span></span>
<span id="cb35-2"><a href=""></a>personas[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   COMUNA  sexo  edad ID_ZONA_LOC  AREA  NVIV ESCOLARIDAD id_viv
    &lt;int&gt; &lt;int&gt; &lt;int&gt;       &lt;int&gt; &lt;int&gt; &lt;int&gt;       &lt;int&gt; &lt;char&gt;
1:  15202     1    73       13225     2     1           4 132251
2:  15202     1    78       13225     2     3           0 132253
3:  15202     2    78       13225     2     3           0 132253
4:  15202     2    52       13225     2     3           2 132253
5:  15202     1    44       13225     2     3           3 132253
6:  15202     1    39       13225     2     9           8 132259</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href=""></a><span class="co"># ... o así</span></span>
<span id="cb37-2"><a href=""></a><span class="co">#personas[1:6]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sintaxis-básica-ejemplos-1" class="slide level2">
<h2>Sintaxis básica: ejemplos</h2>
<h3 id="parametro-i-2">Parametro <span style="color:red">i</span>:</h3>
<p>Podemos usar cualquier condición que queramos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href=""></a>personas[COMUNA <span class="sc">==</span> <span class="dv">15202</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     COMUNA  sexo  edad ID_ZONA_LOC  AREA  NVIV ESCOLARIDAD  id_viv
      &lt;int&gt; &lt;int&gt; &lt;int&gt;       &lt;int&gt; &lt;int&gt; &lt;int&gt;       &lt;int&gt;  &lt;char&gt;
  1:  15202     1    73       13225     2     1           4  132251
  2:  15202     1    78       13225     2     3           0  132253
  3:  15202     2    78       13225     2     3           0  132253
  4:  15202     2    52       13225     2     3           2  132253
  5:  15202     1    44       13225     2     3           3  132253
 ---                                                               
680:  15202     2    53       10876     2    17           1 1087617
681:  15202     2    56       10876     2    19           2 1087619
682:  15202     1    69       10876     2    23           8 1087623
683:  15202     1    66       10876     2    23           0 1087623
684:  15202     2    73          74     2     1           0     741</code></pre>
</div>
</div>
</section>
<section id="sintaxis-básica-ejemplos-2" class="slide level2">
<h2>Sintaxis básica: ejemplos</h2>
<h3 id="parametro-i-3">Parametro <span style="color:red">i</span>:</h3>
<p>El parámetro <em>i</em> también soporta funciones</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href=""></a>personas[<span class="fu">order</span>(COMUNA), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          COMUNA  sexo  edad ID_ZONA_LOC  AREA  NVIV ESCOLARIDAD  id_viv
           &lt;int&gt; &lt;int&gt; &lt;int&gt;       &lt;int&gt; &lt;int&gt; &lt;int&gt;       &lt;int&gt;  &lt;char&gt;
       1:   1101     1    60        7849     1     1          10   78491
       2:   1101     1    38        7849     1     2          15   78492
       3:   1101     2    39        7849     1     3          17   78493
       4:   1101     2    12        7849     1     3           6   78493
       5:   1101     1    41        7849     1     4          17   78494
      ---                                                               
17573999:  16305     2    41       12539     2    75           6 1253975
17574000:  16305     1    45       12539     2    75           9 1253975
17574001:  16305     1     8       12539     2    75           2 1253975
17574002:  16305     1    62       12539     2    76          14 1253976
17574003:  16305     2    60       12539     2    76          12 1253976</code></pre>
</div>
</div>
</section>
<section id="sintaxis-básica-2" class="slide level2">
<h2>Sintaxis básica</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/J_.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</section>
<section id="sintaxis-básica-ejemplos-3" class="slide level2">
<h2>Sintaxis básica: ejemplos</h2>
<p>Podemos combinar selección de filas y columnas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a>personas[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> ,<span class="st">"COMUNA"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   COMUNA
    &lt;int&gt;
1:  15202
2:  15202
3:  15202</code></pre>
</div>
</div>
<div class="fragment">
<p>Es posible seleccionar varias columnas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href=""></a>personas[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> ,<span class="fu">c</span>(<span class="st">"COMUNA"</span>,<span class="st">"AREA"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   COMUNA  AREA
    &lt;int&gt; &lt;int&gt;
1:  15202     2
2:  15202     2
3:  15202     2</code></pre>
</div>
</div>
</div>
</section>
<section id="sintaxis-básica-ejemplos-4" class="slide level2">
<h2>Sintaxis básica: ejemplos</h2>
<p>Podemos utilizar funciones sobre las columnas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href=""></a>personas[, <span class="fu">mean</span>(ESCOLARIDAD)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.34664</code></pre>
</div>
</div>
<div class="fragment">
<p>Podemos calcular min, max, median o cualquier otra función de resumen</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href=""></a>personas[, <span class="fu">min</span>(ESCOLARIDAD)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href=""></a>personas[, <span class="fu">max</span>(ESCOLARIDAD)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href=""></a>personas[, <span class="fu">median</span>(ESCOLARIDAD)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11</code></pre>
</div>
</div>
</div>
</section>
<section id="sintaxis-básica-ejemplos-5" class="slide level2">
<h2>Sintaxis básica: ejemplos</h2>
<p>Utilizando .() es posible ejecutar más de una función</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href=""></a>personas[,.(<span class="fu">mean</span>(ESCOLARIDAD),<span class="fu">max</span>(ESCOLARIDAD))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         V1    V2
      &lt;num&gt; &lt;int&gt;
1: 12.34664    99</code></pre>
</div>
</div>
<div class="fragment">
<p>Es posible asignar los resultados a una columna</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href=""></a>personas[,.(<span class="at">media =</span> <span class="fu">mean</span>(ESCOLARIDAD), <span class="at">max =</span>  <span class="fu">max</span>(ESCOLARIDAD))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      media   max
      &lt;num&gt; &lt;int&gt;
1: 12.34664    99</code></pre>
</div>
</div>
</div>
</section>
<section id="sintaxis-básica-ejemplos-6" class="slide level2">
<h2>Sintaxis básica: ejemplos</h2>
<p>Para crear una columna y mutar nuestro dataframe, utilizamos el operador :=</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href=""></a>personas[, escolaridad2 <span class="sc">:</span><span class="er">=</span> ESCOLARIDAD <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb58-2"><a href=""></a><span class="fu">names</span>(personas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "COMUNA"       "sexo"         "edad"         "ID_ZONA_LOC"  "AREA"        
[6] "NVIV"         "ESCOLARIDAD"  "id_viv"       "escolaridad2"</code></pre>
</div>
</div>
<div class="fragment">
<p><strong>¿Cómo podríamos crear tramos de escolaridad?</strong></p>
</div>
</section>
<section id="sintaxis-básica-ejemplos-7" class="slide level2">
<h2>Sintaxis básica: ejemplos</h2>
<p>En data.table existe una función llamada <code>fifelse</code></p>
<p>Funciona muy parecido a <code>if_else</code> de <code>dplyr</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href=""></a>personas[, escolaridad_tramos <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(ESCOLARIDAD <span class="sc">&gt;=</span> <span class="dv">15</span> <span class="sc">&amp;</span> ESCOLARIDAD <span class="sc">!=</span> <span class="dv">99</span>, <span class="st">"superior"</span>, <span class="st">"otra"</span> )]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>Si queremos una variable <em>dummy</em> para sexo podemos hacer lo siguiente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href=""></a>personas[, hombre_dummy <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(sexo <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span> )]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="sintaxis-básica-3" class="slide level2">
<h2>Sintaxis básica</h2>
<p><br> <br> <br></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/J_BY.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</section>
<section id="sintaxis-básica-4" class="slide level2">
<h2>Sintaxis básica</h2>
<h3 id="parámetro-by">Parámetro <span style="color:green">by</span>:</h3>
<p>Nos permite agrupar por variables.</p>
<p>Esta agrupación siempre se utiliza aplicando funciones a ciertas columnas para hacer resúmenes de los datos.</p>
</section>
<section id="sintaxis-básica-con-by" class="slide level2">
<h2>Sintaxis básica con by</h2>
<p><strong>by</strong>: variable de agrupación</p>
<p><strong>j</strong>: la columna y función que queremos evaluar.</p>
<p>Media de escolaridad, según sexo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href=""></a>personas[,<span class="fu">mean</span>(ESCOLARIDAD), by <span class="ot">=</span> .(sexo)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    sexo       V1
   &lt;int&gt;    &lt;num&gt;
1:     1 12.39874
2:     2 12.29669</code></pre>
</div>
</div>
<div class="fragment">
<p>Podemos incluir todas las variables de agrupación que queramos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href=""></a>personas[,<span class="fu">mean</span>(ESCOLARIDAD), by <span class="ot">=</span> .(sexo, AREA)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    sexo  AREA       V1
   &lt;int&gt; &lt;int&gt;    &lt;num&gt;
1:     1     2 11.24112
2:     2     2 11.13583
3:     2     1 12.44471
4:     1     1 12.57472</code></pre>
</div>
</div>
</div>
</section>
<section id="sintaxis-básica-con-by-1" class="slide level2">
<h2>Sintaxis básica con by</h2>
<p>Existen funciones especiales que comienzan con un punto</p>
<p>La función .N cuenta el número de filas para una agrupación determinada</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href=""></a>personas[, .N , by <span class="ot">=</span> .(sexo, AREA)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    sexo  AREA       N
   &lt;int&gt; &lt;int&gt;   &lt;int&gt;
1:     1     2 1135141
2:     2     2 1014599
3:     2     1 7957415
4:     1     1 7466848</code></pre>
</div>
</div>
</div>
</section>
<section id="sintaxis-básica-con-by-2" class="slide level2">
<h2>Sintaxis básica con by</h2>
<p>La función .SD (<em>subset of data</em>) devuelve una fila arbitraria de un conjunto de datos</p>
<div class="fragment">
<p>En este caso estamos devolviendo la primera fila de la intersección sexo-área</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href=""></a>personas[, .SD[<span class="dv">1</span>] , by <span class="ot">=</span> .(sexo, AREA)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    sexo  AREA COMUNA  edad ID_ZONA_LOC  NVIV ESCOLARIDAD id_viv escolaridad2
   &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;       &lt;int&gt; &lt;int&gt;       &lt;int&gt; &lt;char&gt;        &lt;num&gt;
1:     1     2  15202    73       13225     1           4 132251            5
2:     2     2  15202    78       13225     3           0 132253            1
3:     2     1  15201    79        1767     1           6  17671            7
4:     1     1  15201    46        1767     8          17  17678           18
   escolaridad_tramos hombre_dummy
               &lt;char&gt;        &lt;num&gt;
1:               otra            1
2:               otra            0
3:               otra            0
4:           superior            1</code></pre>
</div>
</div>
</div>
</section>
<section id="concatenando-acciones" class="slide level2">
<h2>Concatenando acciones</h2>
<p>Imagenemos que solo nos interesan las columnas sexo y AREA</p>
<div class="fragment">
<p><code>data.table</code> nos permite concatenar acciones mediante la sintaxis DT[…][…]</p>
</div>
<div class="fragment">
<p>Se lee así:</p>
</div>
<div class="fragment">
<ul>
<li><p>Del dataframe <em>personas</em>, seleccionamos la primera fila de la intersección sexo-AREA, junto a todas las columnas</p></li>
<li><p>Del resultado anterior, extraemos solo las columnas sexo y AREA</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href=""></a>personas[, .SD[<span class="dv">1</span>] , by <span class="ot">=</span> .(sexo, AREA)] [, <span class="fu">c</span>(<span class="st">"sexo"</span>, <span class="st">"AREA"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    sexo  AREA
   &lt;int&gt; &lt;int&gt;
1:     1     2
2:     2     2
3:     2     1
4:     1     1</code></pre>
</div>
</div>
</div>
</section>
<section id="ejercicio" class="slide level2">
<h2>Ejercicio</h2>
<p>Usaremos el dataset iris, que está cargado en R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href=""></a>iris <span class="ot">&lt;-</span> iris</span>
<span id="cb72-2"><a href=""></a>iris_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(iris) </span>
<span id="cb72-3"><a href=""></a><span class="fu">names</span>(iris_dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sepal.Length" "Sepal.Width"  "Petal.Length" "Petal.Width"  "Species"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href=""></a><span class="fu">head</span>(iris_dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
          &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;  &lt;fctr&gt;
1:          5.1         3.5          1.4         0.2  setosa
2:          4.9         3.0          1.4         0.2  setosa
3:          4.7         3.2          1.3         0.2  setosa
4:          4.6         3.1          1.5         0.2  setosa
5:          5.0         3.6          1.4         0.2  setosa
6:          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
</div>
</section>
<section id="ejercicio-1" class="slide level2">
<h2>Ejercicio</h2>
<p>Utilizando <em>iris</em> realice las siguientes operaciones con <code>data.table</code></p>
<ul>
<li><p>Calcule el mínimo de las columnas Sepal.Length y Sepal.Width</p></li>
<li><p>Seleccione la primera fila de cada especie (setosa, virginica y versicolor), conservado únicamente la columna <em>Species</em></p></li>
<li><p>Construya una nueva columna llamada <em>ratio_length_width</em> que sea igual a la división de Petal.Length y Petal.Width</p></li>
<li><p>Calcule la media de <em>ratio_length_width</em> para cada especie y guarde el resultado en una columna llamada <em>media_ratio</em></p></li>
</ul>
</section>
<section id="resumen-hasta-el-momento" class="slide level2">
<h2>Resumen hasta el momento</h2>
<p>Algunos datasets pueden ser desafiantes en cuanto a su tamaño</p>
<div class="fragment">
<p>Los datos del censo 2017 no son especialmente voluminosos, pero aún así pueden causar problemas para un PC doméstico</p>
</div>
<div class="fragment">
<p>Lo más simple es reducir la cantidad de datos cargados</p>
</div>
<div class="fragment">
<p><code>data.table</code> es una herramienta muy poderosa y fácil de utilizar</p>
</div>
<div class="fragment">
<p>Elegir <code>data.table</code> sobre <code>dplyr</code> puede ser la diferencia entre lograr o no la tarea de análisis que nos propongamos</p>
</div>
</section>
<section id="ventajas-de-data.table" class="slide level2">
<h2>Ventajas de data.table</h2>
<ul>
<li><p>Notablemente más rápido y eficiente que <code>dplyr</code></p></li>
<li><p>Muy flexible</p></li>
<li><p>Se encuentra en un estado avanzado de maduración</p></li>
<li><p>Buena documentación oficial</p></li>
<li><p>Comunidad amplia de usuarios</p></li>
</ul>
</section>
<section id="desventajas-de-data.table" class="slide level2">
<h2>Desventajas de data.table</h2>
<ul>
<li><p>La sintaxis no es tan intuitiva</p></li>
<li><p>Solo existe en R: no facilita un trabajo fluido entre lenguajes</p></li>
</ul>
</section></section>
<section>
<section id="apache-arrow" class="title-slide slide level1 center" data-background-color="aquamarine">
<h1>apache arrow</h1>

</section>
<section id="introducción-a-arrow" class="slide level2">
<h2>Introducción a arrow</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/arrow.png" class="quarto-figure quarto-figure-center" width="200"></p>
</figure>
</div>
<p>Implementación en R de la librería Apache Arrow de C++</p>
<div class="fragment">
<p>Provee un backend de c++ para funciones de dplyr</p>
</div>
<div class="fragment">
<p>Usamos la potencia de C++ con sintaxis dplyr</p>
</div>
</section>
<section id="introducción-a-arrow-1" class="slide level2">
<h2>Introducción a arrow</h2>
<p>Utiliza un formato columnar para almacenar los datos en memoria</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/columnar-format.png" class="quarto-figure quarto-figure-center" width="604"></p>
</figure>
</div>
</section>
<section id="primeros-pasos" class="slide level2">
<h2>Primeros pasos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href=""></a><span class="fu">install.packages</span>(<span class="st">"arrow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Arrow funciona muy bien con formatos de datos <em>columnares</em></p>
<div class="fragment">
<p>Dos formatos populares son feather y parquet</p>
</div>
<div class="fragment">
<p>Vamos a guardar nuestro objeto data.table en formato parquet con la función write_parquet</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href=""></a><span class="fu">write_parquet</span>(personas,</span>
<span id="cb77-2"><a href=""></a>              <span class="st">"data/csv-personas-censo-2017/Microdato_Censo2017-Personas.parquet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="primeros-pasos-1" class="slide level2">
<h2>Primeros pasos</h2>
<p>Para leer un archivo parquet, usamos la función read_parquet</p>
<p>El parámetro as_data_frame = F es clave</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href=""></a><span class="fu">library</span>(arrow)</span>
<span id="cb78-2"><a href=""></a></span>
<span id="cb78-3"><a href=""></a>personas <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"data/csv-personas-censo-2017/Microdato_Censo2017-Personas.parquet"</span>, </span>
<span id="cb78-4"><a href=""></a>                            <span class="at">as_data_frame =</span> F, </span>
<span id="cb78-5"><a href=""></a>                            <span class="at">col_select =</span> <span class="fu">c</span>(<span class="st">"COMUNA"</span>, <span class="st">"P08"</span>, <span class="st">"P09"</span>, <span class="st">"ID_ZONA_LOC"</span>, </span>
<span id="cb78-6"><a href=""></a>                                     <span class="st">"AREA"</span>, <span class="st">"NVIV"</span>, <span class="st">"ESCOLARIDAD"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>Ahora tenemos un objeto arrow</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href=""></a><span class="fu">class</span>(personas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Table"        "ArrowTabular" "ArrowObject"  "R6"          </code></pre>
</div>
</div>
</div>
</section>
<section id="explorando-el-dataset" class="slide level2">
<h2>Explorando el dataset</h2>
<p>La función head() devuelve el nombre y tipos de las columnas, pero no los datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href=""></a>personas <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href=""></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Table
6 rows x 7 columns
$COMUNA &lt;int32&gt;
$P08 &lt;int32&gt;
$P09 &lt;int32&gt;
$ID_ZONA_LOC &lt;int32&gt;
$AREA &lt;int32&gt;
$NVIV &lt;int32&gt;
$ESCOLARIDAD &lt;int32&gt;

See $metadata for additional Schema metadata</code></pre>
</div>
</div>
</section>
<section id="repitamos-la-operación-de-antes" class="slide level2">
<h2>Repitamos la operación de antes</h2>
<p>Repetimos la agrupación a nivel de id_viv-sexo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href=""></a>media_escolaridad <span class="ot">&lt;-</span> personas <span class="sc">%&gt;%</span> </span>
<span id="cb83-2"><a href=""></a>  <span class="fu">rename</span>(<span class="at">sexo =</span> P08,</span>
<span id="cb83-3"><a href=""></a>         <span class="at">edad =</span> P09) <span class="sc">%&gt;%</span> </span>
<span id="cb83-4"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">id_viv =</span> <span class="fu">paste0</span>(ID_ZONA_LOC, NVIV)) </span>
<span id="cb83-5"><a href=""></a></span>
<span id="cb83-6"><a href=""></a><span class="fu">tic</span>()</span>
<span id="cb83-7"><a href=""></a>personas_vivienda <span class="ot">&lt;-</span> media_escolaridad <span class="sc">%&gt;%</span> </span>
<span id="cb83-8"><a href=""></a>  <span class="fu">group_by</span>(id_viv, sexo) <span class="sc">%&gt;%</span> </span>
<span id="cb83-9"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">media =</span> <span class="fu">round</span>(<span class="fu">mean</span>(ESCOLARIDAD), <span class="dv">2</span>)) </span>
<span id="cb83-10"><a href=""></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.02 sec elapsed</code></pre>
</div>
</div>
<p>Tarda prácticamente 0 segundos.</p>
<div class="fragment">
<p>Sospechoso…</p>
</div>
</section>
<section id="repitamos-la-operación-de-antes-1" class="slide level2">
<h2>Repitamos la operación de antes</h2>
<p>Revisemos el resultado ¿Es lo que esperábamos?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href=""></a>personas_vivienda <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href=""></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Table (query)
id_viv: string
sexo: int32
media: double

* Grouped by id_viv
See $.data for the source Arrow object</code></pre>
</div>
</div>
</section>
<section id="repitamos-la-operación-de-antes-2" class="slide level2">
<h2>Repitamos la operación de antes</h2>
<p>El código aún no se ejecuta</p>
<p>Para ejecutar el código y “traernos” los resultados, debemos usar <em>collect</em></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href=""></a><span class="fu">tic</span>()</span>
<span id="cb87-2"><a href=""></a>personas_vivienda <span class="ot">&lt;-</span> media_escolaridad <span class="sc">%&gt;%</span> </span>
<span id="cb87-3"><a href=""></a>  <span class="fu">group_by</span>(id_viv, sexo) <span class="sc">%&gt;%</span> </span>
<span id="cb87-4"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">media =</span> <span class="fu">round</span>(<span class="fu">mean</span>(ESCOLARIDAD), <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-5"><a href=""></a>  <span class="fu">collect</span>()</span>
<span id="cb87-6"><a href=""></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.007 sec elapsed</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><code>collect()</code> ejecuta el proceso y devuelve un dataframe</p>
</div>
</section>
<section id="revisemos-el-código" class="slide level2">
<h2>Revisemos el código</h2>
<p>Ahora sí podemos ver datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href=""></a>personas_vivienda <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href=""></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
# Groups:   id_viv [3]
  id_viv  sexo media
  &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;
1 283437     2  6.25
2 283437     1  8.67
3 283438     1  8   
4 283438     2 12   
5 283439     1 11.3 
6 283439     2 12.5 </code></pre>
</div>
</div>
</section>
<section id="explicación" class="slide level2">
<h2>Explicación</h2>
<p>El paquete arrow funciona con algo llamado <em>lazy evalue</em></p>
<div class="fragment">
<p>Las cosas no se evalúan sino hasta que realmente se requieren</p>
</div>
<div class="fragment">
<p>Las funciones <em>collect</em> y <em>compute</em> ejecutan realmente el código</p>
</div>
</section>
<section id="particionando" class="slide level2">
<h2>Particionando</h2>
<p>Vamos a escribir un archivo para cada comuna</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href=""></a><span class="fu">tic</span>()</span>
<span id="cb91-2"><a href=""></a>personas <span class="sc">%&gt;%</span>  </span>
<span id="cb91-3"><a href=""></a>  <span class="fu">group_by</span>(COMUNA) <span class="sc">|&gt;</span></span>
<span id="cb91-4"><a href=""></a>  <span class="fu">write_dataset</span>(<span class="st">"data/particiones"</span>)</span>
<span id="cb91-5"><a href=""></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Importante</strong>: La partición tiene relación con el tipo de consultas</p>
</section>
<section id="leyendo-un-dataset" class="slide level2">
<h2>Leyendo un dataset</h2>
<p>Usamos la función open_dataset, indicando el directorio en el que están los datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href=""></a>personas <span class="ot">&lt;-</span> <span class="fu">open_dataset</span>(<span class="st">"data/particiones"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Volvamos a probar el código de antes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href=""></a>media_escolaridad <span class="ot">&lt;-</span> personas <span class="sc">%&gt;%</span> </span>
<span id="cb93-2"><a href=""></a>  <span class="fu">rename</span>(<span class="at">sexo =</span> P08,</span>
<span id="cb93-3"><a href=""></a>         <span class="at">edad =</span> P09) <span class="sc">%&gt;%</span> </span>
<span id="cb93-4"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">id_viv =</span> <span class="fu">paste0</span>(ID_ZONA_LOC, NVIV)) </span>
<span id="cb93-5"><a href=""></a></span>
<span id="cb93-6"><a href=""></a><span class="fu">tic</span>()</span>
<span id="cb93-7"><a href=""></a>personas_vivienda <span class="ot">&lt;-</span> media_escolaridad <span class="sc">%&gt;%</span> </span>
<span id="cb93-8"><a href=""></a>  <span class="fu">group_by</span>(id_viv, sexo) <span class="sc">%&gt;%</span> </span>
<span id="cb93-9"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">media =</span> <span class="fu">round</span>(<span class="fu">mean</span>(ESCOLARIDAD), <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb93-10"><a href=""></a>  <span class="fu">collect</span>()</span>
<span id="cb93-11"><a href=""></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.191 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="sobrepasando-la-memoria" class="slide level2">
<h2>Sobrepasando la memoria</h2>
<p><strong>¿Qué pasa si tengo que trabajar con un dataset más grande que la memoria del computador?</strong></p>
<div class="fragment">
<p>Vamos a trabajar con un <a href="https://www.kaggle.com/datasets/lopezbec/covid19-tweets-dataset">dataset</a> de 53.6 GB</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/covid-dataset.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</section>
<section id="descripción-dataset" class="slide level2">
<h2>Descripción dataset</h2>
<p>Para cada hora, tenemos un archivo csv</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/ejemplo-dataset.png" class="quarto-figure quarto-figure-center" width="500"></p>
</figure>
</div>
</section>
<section id="cargando-dataset" class="slide level2">
<h2>Cargando dataset</h2>
<p><strong>sources</strong>: directorio con los datos</p>
<p><strong>format</strong>: formato de los archivos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href=""></a><span class="co"># Tabla con detalles</span></span>
<span id="cb95-2"><a href=""></a>details <span class="ot">&lt;-</span> <span class="fu">open_dataset</span>(<span class="at">sources =</span>  <span class="st">"data/twitter/archive/Summary_Details/"</span>,</span>
<span id="cb95-3"><a href=""></a>                        <span class="at">format =</span> <span class="st">"csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href=""></a><span class="fu">names</span>(details)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Tweet_ID"               "Language"               "Geolocation_coordinate"
[4] "RT"                     "Likes"                  "Retweets"              
[7] "Country"                "Date Created"          </code></pre>
</div>
</div>
</section>
<section id="exploremos-tabla-de-detalles" class="slide level2">
<h2>Exploremos tabla de detalles</h2>
<p>Primeras filas del dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href=""></a>details <span class="sc">%&gt;%</span> </span>
<span id="cb98-2"><a href=""></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb98-3"><a href=""></a>  <span class="fu">collect</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 8
  Tweet_ID Language Geolocation_coordinate RT    Likes Retweets Country
   &lt;int64&gt; &lt;chr&gt;    &lt;chr&gt;                  &lt;chr&gt; &lt;int&gt;    &lt;int&gt; &lt;chr&gt;  
1     1e18 en       NO                     NO        0        0 ""     
2     1e18 en       NO                     NO        1        0 ""     
3     1e18 en       NO                     NO        0        0 ""     
4     1e18 fr       NO                     YES       0        3 ""     
5     1e18 fr       NO                     YES       0        3 ""     
# ℹ 1 more variable: `Date Created` &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="exploremos-tabla-de-detalles-1" class="slide level2">
<h2>Exploremos tabla de detalles</h2>
<p>Número total de filas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href=""></a>details <span class="sc">%&gt;%</span> </span>
<span id="cb100-2"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">rows =</span> <span class="fu">n</span>() ) <span class="sc">%&gt;%</span> </span>
<span id="cb100-3"><a href=""></a>  <span class="fu">collect</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
       rows
      &lt;int&gt;
1 245793521</code></pre>
</div>
</div>
<div class="fragment">
<p>Número de tuits por país</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href=""></a><span class="fu">tic</span>()</span>
<span id="cb102-2"><a href=""></a>details <span class="sc">%&gt;%</span> </span>
<span id="cb102-3"><a href=""></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span> </span>
<span id="cb102-4"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">frecuencia =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb102-5"><a href=""></a>  <span class="fu">collect</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 233 × 2
   Country frecuencia
   &lt;chr&gt;        &lt;int&gt;
 1 ""       244518623
 2 "US"        346046
 3 "GB"        108594
 4 "BR"         93078
 5 "ZA"         14317
 6 "AR"         30229
 7 "MX"         29674
 8 "ES"         32944
 9 "CA"         61335
10 "UY"          5238
# ℹ 223 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href=""></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>8.626 sec elapsed</code></pre>
</div>
</div>
</div>
</section>
<section id="ahora-probemos-con-archivos-parquet" class="slide level2">
<h2>Ahora probemos con archivos parquet</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href=""></a>details_parquet <span class="ot">&lt;-</span> <span class="fu">open_dataset</span>(<span class="st">"data/twitter/archive-parquet/Summary_Details"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href=""></a>details_parquet <span class="sc">%&gt;%</span> </span>
<span id="cb107-2"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">rows =</span> <span class="fu">n</span>() ) <span class="sc">%&gt;%</span> </span>
<span id="cb107-3"><a href=""></a>  <span class="fu">collect</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
       rows
      &lt;int&gt;
1 245793521</code></pre>
</div>
</div>
<div class="fragment">
<p>¡Tardamos menos de un segundo!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href=""></a><span class="fu">tic</span>()</span>
<span id="cb109-2"><a href=""></a>details_parquet <span class="sc">%&gt;%</span> </span>
<span id="cb109-3"><a href=""></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span> </span>
<span id="cb109-4"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">frecuencia =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb109-5"><a href=""></a>  <span class="fu">collect</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 233 × 2
   Country frecuencia
   &lt;chr&gt;        &lt;int&gt;
 1 ""       244518623
 2 "FR"         27312
 3 "BR"         93078
 4 "CA"         61335
 5 "MY"         13874
 6 "US"        346046
 7 "PE"          5092
 8 "IN"         70047
 9 "EG"          1725
10 "PY"          2965
# ℹ 223 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href=""></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.999 sec elapsed</code></pre>
</div>
</div>
</div>
</section>
<section id="una-operación-más-compleja" class="slide level2">
<h2>Una operación más compleja</h2>
<p>Carguemos tabla de sentimiento y details desde formato csv</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href=""></a>sentiment_csv <span class="ot">&lt;-</span> <span class="fu">open_dataset</span>(<span class="st">"data/twitter/archive/Summary_Sentiment_ES/"</span>, <span class="at">format =</span> <span class="st">"csv"</span>)</span>
<span id="cb113-2"><a href=""></a>details_csv <span class="ot">&lt;-</span> <span class="fu">open_dataset</span>(<span class="st">"data/twitter/archive/Summary_Details/"</span>, <span class="at">format =</span> <span class="st">"csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href=""></a>details_csv <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href=""></a>  <span class="fu">left_join</span>(sentiment_csv, <span class="at">by =</span> <span class="st">"Tweet_ID"</span>) <span class="sc">%&gt;%</span>  <span class="co"># agregar información de la tabla de sentimientos</span></span>
<span id="cb114-3"><a href=""></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span> </span>
<span id="cb114-4"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">frecuencia =</span> <span class="fu">mean</span>(Probability_pos, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb114-5"><a href=""></a>  <span class="fu">collect</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb114-6"><a href=""></a>  <span class="fu">arrange</span>(Country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 233 × 2
   Country    frecuencia
   &lt;chr&gt;           &lt;dbl&gt;
 1 ""        0.122      
 2 "AD"      0.166      
 3 "AE"      0.190      
 4 "AF"    NaN          
 5 "AG"    NaN          
 6 "AI"    NaN          
 7 "AL"    NaN          
 8 "AM"      0.000000844
 9 "AO"    NaN          
10 "AQ"      0.176      
# ℹ 223 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="tentación-con-parquet" class="slide level2">
<h2>Tentación con parquet</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href=""></a>sentiment_parquet <span class="ot">&lt;-</span> <span class="fu">open_dataset</span>(<span class="st">"data/twitter/archive-parquet/Summary_Sentiment_ES"</span>)</span>
<span id="cb116-2"><a href=""></a>details_parquet <span class="ot">&lt;-</span> <span class="fu">open_dataset</span>(<span class="st">"data/twitter/archive-parquet/Summary_Details"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si corren esto, es probable que sobrepasen la memoria de su computador</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href=""></a>details_csv <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href=""></a>  <span class="fu">left_join</span>(sentiment_csv, <span class="at">by =</span> <span class="st">"Tweet_ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb117-3"><a href=""></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span> </span>
<span id="cb117-4"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">frecuencia =</span> <span class="fu">mean</span>(Probability_pos, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb117-5"><a href=""></a>  <span class="fu">collect</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="algo-más-interesante" class="slide level2">
<h2>Algo más interesante</h2>
<p>Calculemos el número de tuits por hora</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href=""></a><span class="fu">tic</span>()</span>
<span id="cb118-2"><a href=""></a>frecuencia_fecha <span class="ot">&lt;-</span> details_parquet <span class="sc">%&gt;%</span> </span>
<span id="cb118-3"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">year =</span> stringr<span class="sc">::</span><span class="fu">str_sub</span>(<span class="at">start =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">end =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="st">`</span><span class="at">Date Created</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb118-4"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">as.numeric</span>(stringr<span class="sc">::</span><span class="fu">str_sub</span>(<span class="at">start =</span> <span class="dv">12</span>, <span class="at">end =</span> <span class="dv">13</span>, <span class="st">`</span><span class="at">Date Created</span><span class="st">`</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb118-5"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">str_sub</span>(<span class="st">`</span><span class="at">Date Created</span><span class="st">`</span>, <span class="at">start =</span> <span class="dv">5</span>, <span class="at">end =</span> <span class="dv">7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb118-6"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">day =</span> <span class="fu">str_sub</span>(<span class="st">`</span><span class="at">Date Created</span><span class="st">`</span>, <span class="at">start =</span> <span class="dv">9</span>, <span class="at">end =</span> <span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb118-7"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">case_when</span>(</span>
<span id="cb118-8"><a href=""></a>    month <span class="sc">==</span> <span class="st">"Jan"</span> <span class="sc">~</span> <span class="st">"01"</span>,</span>
<span id="cb118-9"><a href=""></a>    month <span class="sc">==</span> <span class="st">"Feb"</span> <span class="sc">~</span> <span class="st">"02"</span>,</span>
<span id="cb118-10"><a href=""></a>    month <span class="sc">==</span> <span class="st">"Mar"</span> <span class="sc">~</span> <span class="st">"03"</span>,</span>
<span id="cb118-11"><a href=""></a>    month <span class="sc">==</span> <span class="st">"Apr"</span> <span class="sc">~</span> <span class="st">"04"</span>,</span>
<span id="cb118-12"><a href=""></a>    month <span class="sc">==</span> <span class="st">"May"</span> <span class="sc">~</span> <span class="st">"05"</span>,</span>
<span id="cb118-13"><a href=""></a>    month <span class="sc">==</span> <span class="st">"Jun"</span> <span class="sc">~</span> <span class="st">"06"</span>,</span>
<span id="cb118-14"><a href=""></a>    month <span class="sc">==</span> <span class="st">"Jul"</span> <span class="sc">~</span> <span class="st">"07"</span>,</span>
<span id="cb118-15"><a href=""></a>    month <span class="sc">==</span> <span class="st">"Aug"</span> <span class="sc">~</span> <span class="st">"08"</span>,</span>
<span id="cb118-16"><a href=""></a>    month <span class="sc">==</span> <span class="st">"Sep"</span> <span class="sc">~</span> <span class="st">"09"</span>,</span>
<span id="cb118-17"><a href=""></a>    month <span class="sc">==</span> <span class="st">"Oct"</span> <span class="sc">~</span> <span class="st">"10"</span>,</span>
<span id="cb118-18"><a href=""></a>    month <span class="sc">==</span> <span class="st">"Nov"</span> <span class="sc">~</span> <span class="st">"11"</span>,</span>
<span id="cb118-19"><a href=""></a>    month <span class="sc">==</span> <span class="st">"Dec"</span> <span class="sc">~</span> <span class="st">"12"</span></span>
<span id="cb118-20"><a href=""></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb118-21"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">paste0</span>( year, <span class="st">"-"</span>, month, <span class="st">"-"</span>, day)) <span class="sc">%&gt;%</span> </span>
<span id="cb118-22"><a href=""></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span> </span>
<span id="cb118-23"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">frecuencia =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb118-24"><a href=""></a>  <span class="fu">collect</span>()</span>
<span id="cb118-25"><a href=""></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>21.738 sec elapsed</code></pre>
</div>
</div>
</section>
<section id="exploremos-la-tabla-resultante" class="slide level2">
<h2>Exploremos la tabla resultante</h2>
<p>Tenemos la frecuencia para cada hora</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href=""></a><span class="fu">head</span>(frecuencia_fecha)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  date       frecuencia
  &lt;chr&gt;           &lt;int&gt;
1 2022-01-07    4628448
2 2022-01-14    4094271
3 2022-01-21    3770035
4 2022-01-28    3435267
5 2022-01-03    4263013
6 2022-01-10    4453089</code></pre>
</div>
</div>
</section>
<section id="editamos-un-poco-la-tabla" class="slide level2">
<h2>Editamos un poco la tabla</h2>
<p>Convertimos a formato fecha</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href=""></a>tabla_plot <span class="ot">&lt;-</span>  frecuencia_fecha <span class="sc">%&gt;%</span> </span>
<span id="cb122-2"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as_date</span>(date)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gráfico-de-frecuencia" class="slide level2">
<h2>Gráfico de frecuencia</h2>
<p>Usamos ggplot para el gráfico</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb123-2"><a href=""></a>tabla_plot <span class="sc">%&gt;%</span> </span>
<span id="cb123-3"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> frecuencia, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb123-4"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb123-5"><a href=""></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb123-6"><a href=""></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%Y %b %d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-53-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="limitaciones-de-arrow" class="slide level2">
<h2>Limitaciones de arrow</h2>
<p>Arrow no tiene todas las funciones implementadas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href=""></a>details_parquet <span class="sc">%&gt;%</span></span>
<span id="cb124-2"><a href=""></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span> </span>
<span id="cb124-3"><a href=""></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb124-4"><a href=""></a>  <span class="fu">collect</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in UseMethod("slice"): no applicable method for 'slice' applied to an object of class "arrow_dplyr_query"</code></pre>
</div>
</div>
</section>
<section id="limitaciones-de-arrow-1" class="slide level2">
<h2>Limitaciones de arrow</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href=""></a>details_parquet <span class="sc">%&gt;%</span></span>
<span id="cb126-2"><a href=""></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span> </span>
<span id="cb126-3"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">max =</span> <span class="fu">max</span>(Retweets)) <span class="sc">%&gt;%</span> </span>
<span id="cb126-4"><a href=""></a>  <span class="fu">collect</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: window functions not currently supported in Arrow
Call collect() first to pull data into R.</code></pre>
</div>
</div>
<p><a href="https://arrow.apache.org/docs/dev/r/reference/acero.html">Aquí</a> encontrarán un listado de las funciones implementadas en <code>arrow</code></p>
</section></section>
<section>
<section id="hay-algo-más-poderoso" class="title-slide slide level1 center" data-background-color="aquamarine">
<h1>¿Hay algo más poderoso?</h1>

</section>
<section id="duckdb" class="slide level2">
<h2>duckdb</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/duckdb-logo.png" class="quarto-figure quarto-figure-center" width="250"></p>
</figure>
</div>
<p>Motor SQL optimizado para análisis de datos</p>
<div class="fragment">
<p>Utiliza un formato columnar</p>
</div>
<div class="fragment">
<p>No es recomendable para aplicaciones que requieran insertar, borrar o editar filas constantemente (transacciones)</p>
</div>
</section>
<section id="primeros-pasos-con-duckdb" class="slide level2">
<h2>Primeros pasos con duckdb</h2>
<p>La instalación puede tomar bastante tiempo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href=""></a><span class="fu">install.packages</span>(<span class="st">"duckdb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nos conectamos a una base de datos efímera (:memory:)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href=""></a><span class="fu">library</span>(DBI)</span>
<span id="cb129-2"><a href=""></a><span class="fu">library</span>(duckdb) </span>
<span id="cb129-3"><a href=""></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">duckdb</span>(), <span class="at">dbdir =</span> <span class="st">":memory:"</span>, <span class="at">read_only =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ejemplo-duckdb" class="slide level2">
<h2>Ejemplo duckdb</h2>
<p>Estamos haciendo la misma operación de hace un rato</p>
<p>Usamos SQL para hacer la consulta (<em>query</em>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href=""></a><span class="fu">tic</span>()</span>
<span id="cb130-2"><a href=""></a><span class="fu">dbGetQuery</span>(con, </span>
<span id="cb130-3"><a href=""></a><span class="st">"SELECT</span></span>
<span id="cb130-4"><a href=""></a><span class="st">  d.Country,</span></span>
<span id="cb130-5"><a href=""></a><span class="st">  MEAN(s.Probability_pos) AS frecuencia</span></span>
<span id="cb130-6"><a href=""></a><span class="st">FROM</span></span>
<span id="cb130-7"><a href=""></a><span class="st">  parquet_scan('data/twitter/archive-parquet/Summary_Details/**/*.parquet')  d</span></span>
<span id="cb130-8"><a href=""></a><span class="st">LEFT JOIN</span></span>
<span id="cb130-9"><a href=""></a><span class="st">  parquet_scan('data/twitter/archive-parquet/Summary_Sentiment_ES/**/*.parquet')  s</span></span>
<span id="cb130-10"><a href=""></a><span class="st">ON</span></span>
<span id="cb130-11"><a href=""></a><span class="st">  d.Tweet_ID = s.Tweet_ID</span></span>
<span id="cb130-12"><a href=""></a><span class="st">GROUP BY</span></span>
<span id="cb130-13"><a href=""></a><span class="st">  d.Country</span></span>
<span id="cb130-14"><a href=""></a><span class="st">ORDER BY d.Country</span></span>
<span id="cb130-15"><a href=""></a><span class="st">;"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Country        frecuencia
1           0.121597815610398
2        AD 0.165783264040528
3        AE 0.189881096980133
4        AF                NA
5        AG                NA
6        AI                NA
7        AL                NA
8        AM 0.000000844011195
9        AO                NA
10       AQ 0.175814010816745
11       AR 0.124793020539232
12       AS                NA
13       AT 0.168973293866395
14       AU 0.169046130392544
15       AW 0.190112296282627
16       AZ                NA
17       BA                NA
18       BB 0.248946130082965
19       BD 0.249542773845179
20       BE 0.177134819700438
21       BF                NA
22       BG 0.041929243348659
23       BH 0.109210651289200
24       BI                NA
25       BJ 0.492586227613489
26       BL                NA
27       BM                NA
28       BN 0.497892259205575
29       BO 0.134917910960514
30       BQ 0.255765331182464
31       BR 0.326580412104430
32       BS 0.116459298470962
33       BT                NA
34       BW 0.292532361948081
35       BY                NA
36       BZ                NA
37       CA 0.146103034776458
38       CC                NA
39       CD 0.454974677158180
40       CF                NA
41       CG 0.182146547923854
42       CH 0.108289841074764
43       CI 0.210084730963067
44       CK                NA
45       CL 0.120312905603788
46       CM 0.392821664675869
47       CN 0.105354951449691
48       CO 0.120845594278489
49       CR 0.105753377581348
50       CU 0.185385343919912
51       CV                NA
52       CW 0.000000000058153
53       CY 0.335102996205717
54       CZ 0.240161345304226
55       DE 0.154813249789114
56       DJ                NA
57       DK 0.072759803117587
58       DM 0.051365715397046
59       DO 0.126666580603485
60       DZ 0.157831446491264
61       EC 0.120741276203072
62       EE 0.089840464176343
63       EG 0.247141950160636
64       ER                NA
65       ES 0.125766350019808
66       ET 0.410723763551781
67       FI 0.073305757641209
68       FJ 0.497892259205575
69       FK                NA
70       FO                NA
71       FR 0.175154512047886
72       GA 0.497892259205575
73       GB 0.181773694937854
74       GD                NA
75       GE 0.030377491952999
76       GF 0.077002917350632
77       GG                NA
78       GH 0.332180733363349
79       GI 0.317997788629000
80       GL                NA
81       GM                NA
82       GN 0.051112372491556
83       GP 0.497892259205575
84       GQ 0.056547149793291
85       GR 0.084046715165551
86       GT 0.120947853456882
87       GU                NA
88       GW 0.345334477521430
89       GY                NA
90       HK 0.124544856268460
91       HN 0.129895369942232
92       HR 0.304871807773215
93       HT 0.000056905937197
94       HU 0.192165133126378
95       ID 0.414299056561080
96       IE 0.110314332094787
97       IL 0.149855880105761
98       IM                NA
99       IN 0.452098850577955
100      IO                NA
101      IQ                NA
102      IR 0.086416004854744
103      IS 0.342846345434957
104      IT 0.170501400703483
105      JE                NA
106      JM 0.119944787196746
107      JO                NA
108      JP 0.111023596263983
109      KE 0.401598675859143
110      KG                NA
111      KH                NA
112      KI                NA
113      KM                NA
114      KN                NA
115      KP                NA
116      KR 0.099177355190016
117      KW 0.448104286478518
118      KY 0.000038969996163
119      KZ 0.014989462830596
120      LA                NA
121      LB 0.058997324812816
122      LC 0.487280196021403
123      LI 0.213298885268088
124      LK 0.497892259205575
125      LR                NA
126      LS 0.345533284078569
127      LT 0.248970087779172
128      LU                NA
129      LV 0.273435701478852
130      LY                NA
131      MA 0.040990798287330
132      MC                NA
133      MD 0.657825493202254
134      ME 0.000003664914128
135      MF                NA
136      MG 0.173208951015844
137      MH                NA
138      MK                NA
139      ML 0.000616484708655
140      MM                NA
141      MN                NA
142      MO 0.000014701077713
143      MP                NA
144      MQ 0.360820579080287
145      MR                NA
146      MS                NA
147      MT 0.132433780590877
148      MU                NA
149      MV 0.497892259205575
150      MW 0.497892259205575
151      MX 0.131732951984859
152      MY 0.481007544054525
153      MZ 0.084202144157194
154      NC                NA
155      NE 0.497892259205575
156      NF                NA
157      NG 0.473342400190572
158      NI 0.265998269124630
159      NL 0.156170288524055
160      NO 0.113568569892839
161      NP 0.337902876406686
162      NR                NA
163      NU                NA
164      NZ 0.078193696193010
165      OM 0.322354357406619
166      PA 0.112455563422732
167      PE 0.125680196710619
168      PF                NA
169      PG                NA
170      PH 0.414097981470971
171      PK 0.392783368116102
172      PL 0.117816303915896
173      PM                NA
174      PR 0.107858276385523
175      PT 0.185299346853967
176      PW                NA
177      PY 0.126629972527394
178      QA 0.092375888051706
179      RE 0.473755446552898
180      RO 0.155936060572888
181      RS 0.375315097779593
182      RU 0.122935208279728
183      RW 0.168760781868997
184      SA 0.217280427705873
185      SB                NA
186      SC 0.497892259205575
187      SD                NA
188      SE 0.160380622740258
189      SG 0.246979525696651
190      SI 0.036148482194268
191      SK 0.017855239562030
192      SL                NA
193      SM                NA
194      SN 0.181368797810234
195      SO                NA
196      SR                NA
197      ST                NA
198      SV 0.131203959394034
199      SX 0.497892259205575
200      SY 0.249010372857086
201      SZ                NA
202      TC                NA
203      TD                NA
204      TG                NA
205      TH 0.130102985000433
206      TJ                NA
207      TL 0.224576621188328
208      TM                NA
209      TN 0.096909678244038
210      TO                NA
211      TR 0.271165941624752
212      TT 0.150265292993123
213      TW 0.020616353213198
214      TZ 0.550000362793207
215      UA 0.310296826714056
216      UG 0.497892259205575
217      US 0.180845713484856
218      UY 0.120369844426840
219      UZ                NA
220      VA                NA
221      VC                NA
222      VE 0.156628746706025
223      VG                NA
224      VI                NA
225      VN 0.119214932771531
226      VU                NA
227      WS                NA
228      XK 0.497892259205575
229      YE 0.054019592366103
230      YT                NA
231      ZA 0.393983444158674
232      ZM 0.229736913403518
233      ZW 0.497892259205575</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href=""></a><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.435 sec elapsed</code></pre>
</div>
</div>
</section></section>
<section>
<section id="qué-pasa-si-no-quiero-usar-sql" class="title-slide slide level1 center">
<h1>¿Qué pasa si no quiero usar SQL?</h1>

</section>
<section id="dbplyr" class="slide level2">
<h2>dbplyr</h2>
<p><code>dbplyr</code> es un paquete que nos permite interactuar con una base de datos usando las funciones de <code>dplyr</code></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/dbplyr.png" class="quarto-figure quarto-figure-center" width="150"></p>
</figure>
</div>
</section>
<section id="ejemplo-dbplyr" class="slide level2">
<h2>Ejemplo dbplyr</h2>
<p>Vamos a conectarnos a una base de datos compacta</p>
<p>Contiene versiones pequeñas de los datos que hemos estado usando</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href=""></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">duckdb</span>(), <span class="at">dbdir =</span> <span class="st">"data/twitter.db"</span>, <span class="at">read_only =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>Al igual que con <code>arrow</code>, debemos usar <code>collect</code> para traernos los datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href=""></a><span class="fu">tbl</span>(con, <span class="st">"details"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb135-2"><a href=""></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span> </span>
<span id="cb135-3"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">frecuencia =</span> <span class="fu">n</span>() ) <span class="sc">%&gt;%</span> </span>
<span id="cb135-4"><a href=""></a>  <span class="fu">collect</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 105 × 2
   Country frecuencia
   &lt;chr&gt;        &lt;dbl&gt;
 1 AR             297
 2 EG               4
 3 KW               3
 4 UY              49
 5 RS               2
 6 PY              21
 7 BO               5
 8 BD               2
 9 RE               1
10 VN               1
# ℹ 95 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="podemos-hacer-left_join" class="slide level2">
<h2>Podemos hacer left_join</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href=""></a><span class="fu">tbl</span>(con, <span class="st">"details"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb137-2"><a href=""></a>  <span class="fu">left_join</span>( <span class="fu">tbl</span>(con, <span class="st">"sentiment"</span>), <span class="at">by =</span> <span class="st">"Tweet_ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb137-3"><a href=""></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span> </span>
<span id="cb137-4"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">frecuencia =</span> <span class="fu">mean</span>(Probability_pos, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb137-5"><a href=""></a>  <span class="fu">collect</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>Para cerrar la conexión con la base de datos, usamos <code>dbDisconnect</code></p>
</div>
</section>
<section id="ejercicio-final" class="slide level2">
<h2>Ejercicio final</h2>
<p>Abre el archivo del censo en formato parquet</p>
<p>Escribe un dataset, usando la comuna como variable de agrupación</p>
<p>Lee el dataset que creaste</p>
<p>Crea una columna que sea 1 cuando una persona es profesional (p15 = 12) y cero cuando no</p>
<p>Calcula el número de personas profesionales por comuna</p>
<p>Bonus: Calcula el porcentaje de profesionales a nivel comunal</p>
</section>
<section id="tabla-comparativa" class="slide level2">
<h2>Tabla comparativa</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table" data-quarto-postprocess="true" style="font-size: 18px; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">dplyr</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">data.table</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">arrow</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">duckdb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">tamaño del dataset</td>
<td style="text-align: left;">pequeño</td>
<td style="text-align: left;">medio</td>
<td style="text-align: left;">grande</td>
<td style="text-align: left;">grande</td>
</tr>
<tr class="even">
<td style="text-align: left;">flexibilidad</td>
<td style="text-align: left;">muy flexible</td>
<td style="text-align: left;">muy flexible</td>
<td style="text-align: left;">poco flexible</td>
<td style="text-align: left;">flexible</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sintaxis</td>
<td style="text-align: left;">muy sencilla</td>
<td style="text-align: left;">sencilla</td>
<td style="text-align: left;">muy sencilla</td>
<td style="text-align: left;">compleja</td>
</tr>
<tr class="even">
<td style="text-align: left;">comunicación con otros lenguajes</td>
<td style="text-align: left;">solo R</td>
<td style="text-align: left;">solo R</td>
<td style="text-align: left;">formato compatible con python y otros lenguajes</td>
<td style="text-align: left;">muy compatible con otros lenguajes</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
<section id="comentarios-finales" class="slide level2">
<h2>Comentarios finales</h2>
<div>
<ul>
<li class="fragment"><code>dplyr</code> es una excelente herramienta cuando nuestro dataset es pequeño</li>
<li class="fragment">En cierto punto, <code>dplyr</code> deja de ser útil</li>
<li class="fragment"><code>R</code> ofrece varias herramientas para procesar grandes volúmenes de información
<ul>
<li class="fragment">data.table</li>
<li class="fragment">arrow</li>
</ul></li>
<li class="fragment"><code>data.table</code> es la herramienta ideal cuando tenemos algunos millones de filas</li>
</ul>
</div>
</section>
<section id="comentarios-finales-1" class="slide level2">
<h2>Comentarios finales</h2>
<div>
<ul>
<li class="fragment"><code>arrow</code> es una muy buena alternativa para quienes quieren mantenerse en el <code>tidyverse</code></li>
<li class="fragment">Logramos procesar más de 240 millones de registros en una máquina modesta
<ul>
<li class="fragment">16 GB RAM</li>
<li class="fragment">16 hilos</li>
</ul></li>
<li class="fragment"><code>duckdb</code> es una base de datos altamente optimizada para análisis de datos
<ul>
<li class="fragment">Vale la pena cuando ya tenemos varios GB de datos</li>
</ul></li>
</ul>
</div>
</section></section>
<section>
<section id="hay-algo-después-de-duckdb" class="title-slide slide level1 center">
<h1><strong>¿Hay algo después de duckdb?</strong></h1>

</section>
<section id="big-data" class="slide level2">
<h2>Big data</h2>
<p>High performance computing (HPC)</p>
<p>Computación distribuida</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/big-data-logos.png" class="quarto-figure quarto-figure-center" width="550"></p>
</figure>
</div>
</section></section>
<section id="métodos-computacionales-para-las-ciencias-sociales" class="title-slide slide level1 center" data-background-color="aquamarine">
<h1>Métodos computacionales para las ciencias sociales</h1>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
              // target, if specified
              link.setAttribute("target", "_blank");
              if (link.getAttribute("rel") === null) {
                link.setAttribute("rel", "noopener");
              }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>